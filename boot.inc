#-------------------------------------------------------------------------------------------
# loader 和 kernel
#-------------------------------------------------------------------------------------------
.equ LOADER_BASE_ADDR, 0x900
.equ LOADER_START_SECTOR, 0x2

#-------------------------------------------------------------------------------------------




#-------------------------------------------------------------------------------------------
# gdt 描述符属性
# 格式为DESC_属性_值, 左移代表其在段描述符高32位的第几位
#-------------------------------------------------------------------------------------------
# 粒度为4, 操作数是32位, 32位代码, AVL是随便设置的
.equ DESC_G_4K, 1 << 23
.equ DESC_D_32, 1 << 22
.equ DESC_L_32, 0 << 21
.equ DESC_AVL,  0 << 20

# 代码段，数据段，显存段段界限的第二段
.equ DESC_LIMIT_CODE2, 16 << 16         # (1111b << 16)
.equ DESC_LIMIT_DATA2, DESC_LIMIT_CODE2
.equ DESC_LIMIT_VIDEO2, 0x0000 << 16

# 段是否在内存上
.equ DESC_P, 1 << 15

# DPL 段描述符特权级
.equ DESC_DPL_0, 0 << 13
.equ DESC_DPL_1, 1 << 13
.equ DESC_DPL_2, 2 << 13
.equ DESC_DPL_3, 3 << 13

# 代码段, 数据段, 系统段
.equ DESC_S_CODE, 1 << 12
.equ DESC_S_DATA, DESC_S_CODE
.equ DESC_S_SYS,  0 << 12

# 代码段可执行, 非一致性, 不可读, 已访问位置0
# 数据段不可执行, 向上扩展, 可写, 已访问位置0
.equ DESC_TYPE_CODE, 8 << 8 # (1000b << 8)
.equ DESC_TYPE_DATA, 2 << 8 # (0010b << 8)

# 代码段,数据段, 显存段描述符的高4字节
.equ DESC_CODE_HIGH4, (0x00 << 24) + DESC_G_4K + DESC_D_32 + DESC_L_32 + DESC_AVL + DESC_LIMIT_CODE2 + DESC_P + DESC_DPL_0 + DESC_S_CODE + DESC_TYPE_CODE + 0x00
.equ DESC_DATA_HIGH4, (0x00 << 24) + DESC_G_4K + DESC_D_32 + DESC_L_32 + DESC_AVL + DESC_LIMIT_DATA2 + DESC_P + DESC_DPL_0 + DESC_S_DATA + DESC_TYPE_DATA + 0x00
.equ DESC_VIDEO_HIGH4, (0x00 << 24) + DESC_G_4K + DESC_D_32 + DESC_L_32 + DESC_AVL + DESC_LIMIT_VIDEO2 + DESC_P + DESC_DPL_0 + DESC_S_DATA + DESC_TYPE_DATA + 0xb
#-------------------------------------------------------------------------------------------



#-------------------------------------------------------------------------------------------
# 段选择子属性
#-------------------------------------------------------------------------------------------
.equ RPL0, 0
.equ RPL1, 1
.equ RPL2, 2
.equ RPL3, 3
.equ TI_GDT, 0 << 2
.equ TI_LDT, 1 << 2
#-------------------------------------------------------------------------------------------
